<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive 3-Step Bars — Inline Info + Music Logo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f7f8fb;
      --ink:#0f172a;
      --muted:#475569;
      --accent:#007bff;
      --pink:#ff69b4; --blue:#1e90ff; --green:#32cd32;
      --bar-w:46px;          /* inactive width */
      --bar-w-active:108px;  /* active width */
      --bar-radius:10px;
      --shadow: 2px 6px 14px rgba(0,0,0,.12);
      --card:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      background:var(--bg); color:var(--ink);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    .chart-wrapper{
      width:min(1080px, 96vw);
      padding:16px;
      display:flex; align-items:center; gap:16px;
    }

    .arrow{
      font-size:2.2rem; line-height:1;
      cursor:pointer; user-select:none;
      color:#333; padding:8px 6px; display:grid; place-items:center;
      width:48px; height:48px; border-radius:12px;
      transition:background .2s ease, color .2s ease, transform .12s ease;
    }
    .arrow:hover{ background:#eef3ff; color:var(--accent) }
    .arrow:active{ transform:scale(.96) }
    .arrow[aria-disabled="true"]{ opacity:.35; pointer-events:none }

    /* Main container: bars + info live together */
    .chart-container{
      flex:1 1 auto;
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:20px;
      align-items:stretch;
    }

    /* Left area (bars + coin) */
    .bars-wrap{
      position:relative;
      background:#fff; border-radius:16px; box-shadow:var(--shadow);
      padding:18px 20px 18px 76px;      /* left padding for coin */
      display:flex; align-items:flex-end; justify-content:center;
      min-height:420px;
      overflow:hidden;
    }

    /* Floating music “coin” that visually represents the chart */
    .logo-coin{
      position:absolute; left:18px; bottom:18px;
      width:56px; height:56px; border-radius:50%;
      display:grid; place-items:center;
      background: radial-gradient(120% 120% at 30% 25%, #ffffff 0%, #eef3ff 60%, #dfe7ff 100%);
      box-shadow: 0 10px 22px rgba(15,23,42,.10), inset 0 0 0 6px rgba(255,255,255,.5);
      animation: coinFloat 2.2s ease-in-out infinite alternate;
    }
    @keyframes coinFloat{
      from{ transform: translateY(0) }
      to{   transform: translateY(-6px) }
    }
    .logo-coin svg{ width:28px; height:28px; color:#0f1b2b }

    /* Bars */
    .bars{
      display:flex; align-items:flex-end; gap:16px; position:relative;
    }
    .x-axis{
      position:absolute; left:76px; right:20px; bottom:14px;
      height:2px; background:#333; opacity:.6; border-radius:2px;
    }

    .bar{
      position:relative;
      width:var(--bar-w);
      height:60px;
      border-radius: var(--bar-radius) var(--bar-radius) 0 0;
      box-shadow: var(--shadow);
      transform-origin: 50% 100%;
      transition:
        height .6s cubic-bezier(.2,.7,.2,1),
        width .35s ease,
        transform .35s ease,
        filter .35s ease;
      cursor:pointer; outline:none;
    }
    .bar:focus-visible{ box-shadow:0 0 0 3px rgba(0,123,255,.35), var(--shadow); }

    .bar[data-i="0"]{ background:var(--pink) }
    .bar[data-i="1"]{ background:var(--blue) }
    .bar[data-i="2"]{ background:var(--green) }

    .bar:hover{ filter:brightness(1.04) }
    .bar.active{ width:var(--bar-w-active); transform: translateY(-4px) }

    /* Note badge on the active bar (replaces the numeric bubble) */
    .note-badge{
      position:absolute; left:50%; transform:translate(-50%, -8px);
      bottom:100%;
      background:#0f172a; color:#fff; padding:6px 8px; border-radius:10px;
      opacity:0; pointer-events:none;
      transition: opacity .25s ease, transform .25s ease;
      display:flex; align-items:center; gap:6px;
    }
    .note-badge svg{ width:16px; height:16px }
    .bar.active .note-badge{ opacity:1; transform:translate(-50%, -12px) }
    .note-badge::after{
      content:""; position:absolute; left:50%; transform:translateX(-50%);
      top:100%; border:6px solid transparent; border-top-color:#0f172a;
    }

    /* Labels under bars */
    .labels{
      position:absolute; left:76px; right:20px; bottom:0;
      display:flex; justify-content:center; gap:16px; translate:0 8px;
    }
    .label{
      width:var(--bar-w); text-align:center; font-size:.9rem; color:#1f2937;
      transition: width .35s ease, font-weight .1s ease;
      white-space:nowrap;
    }
    .label.active{ width:var(--bar-w-active); font-weight:700 }

    /* Dots row */
    .dots{ display:flex; gap:8px; justify-content:center; margin-top:6px }
    .dot{
      width:8px; height:8px; border-radius:50%; background:#cbd5e1; transition:transform .2s ease, background .2s ease
    }
    .dot.active{ background:#0ea5e9; transform:scale(1.2) }

    /* Inline info card (to the right of bars) */
    .info-card{
      background:var(--card); border-radius:16px; box-shadow:var(--shadow);
      padding:18px 16px;
      display:flex; flex-direction:column; gap:10px;
      align-self:stretch;
    }
    .info-meta{ color:var(--muted); font-size:.92rem; display:flex; gap:8px; align-items:center }
    .info-title{ font-size:1.15rem; margin:0 }
    .info-desc{ margin:0; color:var(--muted); line-height:1.5 }

    /* Small music mark in the card header */
    .info-mark{
      width:28px; height:28px; border-radius:8px; display:grid; place-items:center;
      background:#eef3ff; color:#0f1b2b;
    }
    .info-head{ display:flex; align-items:center; gap:10px }

    /* Responsive: stack card below bars on small screens */
    @media (max-width: 840px){
      .chart-container{ grid-template-columns: 1fr; }
      .bars-wrap{ min-height:440px; padding-left:64px }
      .x-axis{ left:64px }
      .labels{ left:64px }
      .info-card{ min-height: 180px }
    }
  </style>
</head>
<body>

  <!-- SVG symbols for music note we reuse -->
  <svg width="0" height="0" style="position:absolute; left:-9999px; visibility:hidden" aria-hidden="true">
    <symbol id="icon-music" viewBox="0 0 24 24">
      <path fill="currentColor" d="M19 3v10.55A4 4 0 1 1 17 17V7h-6v8.55A4 4 0 1 1 9 17V5a1 1 0 0 1 1-1h8z"/>
    </symbol>
  </svg>

  <div class="chart-wrapper" role="region" aria-label="Three step interactive chart">
    <!-- LEFT ARROW -->
    <div class="arrow left-arrow" aria-label="Previous step" role="button" tabindex="0">&#9664;</div>

    <!-- BARS + INLINE INFO -->
    <div class="chart-container">
      <!-- Bars side -->
      <div class="bars-wrap">
        <div class="logo-coin" aria-hidden="true">
          <svg viewBox="0 0 24 24"><use href="#icon-music"/></svg>
        </div>

        <div class="bars" aria-live="polite">
          <div class="bar" data-i="0" data-height="260" data-title="Understand" data-desc="Clarify your intent (calm, boost, focus) and the context where you’ll listen."
               tabindex="0" role="button" aria-pressed="false">
            <div class="note-badge"><svg viewBox="0 0 24 24"><use href="#icon-music"/></svg><span>Step 1</span></div>
          </div>
          <div class="bar" data-i="1" data-height="310" data-title="Interpret" data-desc="Analyze audio features (tempo, energy, timbre) that map to your goal."
               tabindex="0" role="button" aria-pressed="false">
            <div class="note-badge"><svg viewBox="0 0 24 24"><use href="#icon-music"/></svg><span>Step 2</span></div>
          </div>
          <div class="bar" data-i="2" data-height="360" data-title="Curate" data-desc="Select and order tracks to deliver the effect, then refresh over time."
               tabindex="0" role="button" aria-pressed="false">
            <div class="note-badge"><svg viewBox="0 0 24 24"><use href="#icon-music"/></svg><span>Step 3</span></div>
          </div>
        </div>

        <div class="x-axis" aria-hidden="true"></div>

        <div class="labels" aria-hidden="true">
          <div class="label" data-i="0">Understand</div>
          <div class="label" data-i="1">Interpret</div>
          <div class="label" data-i="2">Curate</div>
        </div>
      </div>

      <!-- Info side (inline, next to the graph) -->
      <div class="info-card" aria-live="polite" aria-atomic="true">
        <div class="info-meta"><strong id="stepIndex">Step 1</strong> · <span id="stepName">Understand</span></div>
        <div class="info-head">
          <div class="info-mark" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="18" height="18"><use href="#icon-music"/></svg>
          </div>
          <h3 id="infoTitle" class="info-title">Understand</h3>
        </div>
        <p id="infoDesc" class="info-desc">Clarify your intent (calm, boost, focus) and the context where you’ll listen.</p>

        <div class="dots" aria-hidden="true" style="margin-top:8px">
          <div class="dot" data-i="0"></div>
          <div class="dot" data-i="1"></div>
          <div class="dot" data-i="2"></div>
        </div>
      </div>
    </div>

    <!-- RIGHT ARROW -->
    <div class="arrow right-arrow" aria-label="Next step" role="button" tabindex="0">&#9654;</div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const bars   = Array.from(document.querySelectorAll('.bar'));
      const labels = Array.from(document.querySelectorAll('.label'));
      const dots   = Array.from(document.querySelectorAll('.dot'));
      const leftArrow  = document.querySelector('.left-arrow');
      const rightArrow = document.querySelector('.right-arrow');

      // Info elements (inline card)
      const stepIndexEl = document.getElementById('stepIndex');
      const stepNameEl  = document.getElementById('stepName');
      const infoTitle   = document.getElementById('infoTitle');
      const infoDesc    = document.getElementById('infoDesc');

      let active = 0;

      // Initialize subtle baseline heights and badges
      bars.forEach((b, i) => {
        const base = Math.max(60, (parseInt(b.dataset.height, 10) || 200) * 0.35);
        b.style.height = base + 'px';
        // Accessible name
        b.setAttribute('aria-label', `${b.dataset.title} — activate`);
      });

      function updateArrows(){
        leftArrow.setAttribute('aria-disabled', active === 0 ? 'true' : 'false');
        rightArrow.setAttribute('aria-disabled', active === bars.length-1 ? 'true' : 'false');
      }

      function setActive(i, opts = { instant:false }){
        active = Math.max(0, Math.min(bars.length-1, i));

        bars.forEach((b, idx) => {
          const target = parseInt(b.dataset.height, 10) || 200;
          const base   = Math.max(60, target * 0.35);
          const isActive = idx === active;

          b.classList.toggle('active', isActive);
          b.setAttribute('aria-pressed', isActive ? 'true' : 'false');

          // set height
          if (opts.instant){
            b.style.transitionDuration = '0s';
          } else {
            b.style.transitionDuration = idx === active ? '.7s' : '.45s';
          }
          b.style.height = (isActive ? target : base) + 'px';

          // bounce feel on active
          if (!opts.instant && isActive){
            b.animate(
              [
                { transform: 'translateY(-4px)' },
                { transform: 'translateY(-10px)' },
                { transform: 'translateY(-6px)' },
                { transform: 'translateY(-4px)' }
              ],
              { duration: 520, easing: 'cubic-bezier(.2,.7,.2,1)' }
            );
          }
        });

        labels.forEach((l, idx) => l.classList.toggle('active', idx === active));
        dots.forEach((d, idx)   => d.classList.toggle('active', idx === active));

        // Update inline info card
        const bar  = bars[active];
        const title= bar.dataset.title || `Step ${active+1}`;
        const desc = bar.dataset.desc  || '';

        stepIndexEl.textContent = `Step ${active+1}`;
        stepNameEl .textContent = title;

        infoTitle.animate([{opacity:0, transform:'translateY(4px)'},{opacity:1, transform:'translateY(0)'}], {duration:220, easing:'ease-out'});
        infoDesc .animate([{opacity:0},{opacity:1}], {duration:220, easing:'ease-out'});

        infoTitle.textContent = title;
        infoDesc .textContent = desc;

        updateArrows();
      }

      // Arrow handlers
      const goLeft  = () => setActive(active - 1);
      const goRight = () => setActive(active + 1);
      leftArrow .addEventListener('click', goLeft);
      rightArrow.addEventListener('click', goRight);
      leftArrow .addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') goLeft(); });
      rightArrow.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') goRight(); });

      // Click/keyboard on bars
      bars.forEach((b, idx) => {
        b.addEventListener('click', () => setActive(idx));
        b.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); setActive(idx); }
          if (e.key === 'ArrowLeft')  { e.preventDefault(); setActive(idx-1); }
          if (e.key === 'ArrowRight') { e.preventDefault(); setActive(idx+1); }
        });
      });

      // Page-level arrow keys
      document.addEventListener('keydown', e => {
        if (e.target.closest('.bar') || e.target.closest('.arrow')) return;
        if (e.key === 'ArrowLeft')  goLeft();
        if (e.key === 'ArrowRight') goRight();
      });

      // First paint
      setActive(0, { instant:true });
      requestAnimationFrame(() => { bars.forEach(b => b.style.transitionDuration = ''); });

      // Keep layout tidy on resize
      window.addEventListener('resize', () => setActive(active, { instant:true }));
    });
  </script>
</body>
</html>
